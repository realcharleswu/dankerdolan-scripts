#!/usr/bin/bash
STATUS=""
VPN_PATH=""
no_args=false
one_arg=false
two_args=false
usage="Usage:\n\t./pentest_tmux [session start directory] [VPN file directory]\nIf passing with no arguments, make sure you have a ~/Practice/htb/rooms/ and a ~/Practice/htb/vpn_files directory."
if "$#" -eq 0; then
	no_args=true
elif [ "$#" -eq 1 ]; then
	one_arg=true
	if [ "$1" == "--help" || "$1" == "-h"]
	then
		echo $usage
		exit 0
	fi
elif [ "$#" -eq 2 ]; then
    	two_args=true
elif [ "$#" -gt 2 ]; then
    echo "Too many arguments provided, use -h or --help for usage info."
    exit 1
fi

# both default paths used
if $no_args; then
	STATUS="[x] Argument not passed, default path(~/Practice/htb and ~/Practice/vpn_files) used."
	cd ~/Practice/htb
	VPN_PATH="~/Practice/vpn_files"
# path given by user, vpn path default
elif $one_args; then
	if [ -d "$1" ]
       	then
		STATUS="[*] Path set to $1. VPN Path set to default: ~/Practice/vpn_files."
		cd $1
		VPN_PATH="~/Practice/vpn_files"
	else
		echo "[*] Directory did not exist, creating $1."
		mkdir $1 2>/dev/null
		if [ -d "$1" ]
		then
			STATUS="[*] Directory created, path set to $1."; sleep 1;
			cd $1
		else
			echo "[x] Path could not be made, aborting."
			exit 1
		fi
	fi
# both paths given by user
elif $two_args; then
	# both paths exist
	if [ -d "$1" && -d "$2"]	
	then
		STATUS="[*] Path set to $1. VPN Path set to $2."
		cd $1
		VPN_PATH="$2"
	elif [-d "$1" && ! -d $2]
		then
			STATUS="[*] Path set to $1. Given VPN directory given did not exist, creating $2"
			cd $1
			mkdir $2 2>/dev/null
			VPN_PATH="$2"
		else 


fi

echo $STATUS; sleep 1;
session="pentest"

tmux new-session -d -s $session -n 'main'
tmux split-window -h
tmux split-window -v -p 33
tmux send-keys "tty-clock" Enter
tmux new-window -d -t '=pentest' -n 'second'
tmux select-window -t $session:1
tmux split-window -h
tmux new-window -d -t '=pentest' -n 'openvpn'
tmux select-window -t $session:2
tmux send-keys "cd ~/Practice/vpn_files" Enter
tmux select-window -t $session:0
tmux select-pane -t 0
tmux attach
